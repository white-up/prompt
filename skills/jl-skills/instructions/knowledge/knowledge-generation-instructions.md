# 知识库生成指令 (Knowledge Generation Instructions)

## ⚠️ 执行规则 (EXECUTION RULES)

```
🛑 CRITICAL: 
- 每个步骤输出后 MUST STOP
- 等待用户回复后才能继续
- 一次回复只输出一个步骤的内容
- 违反此规则将导致流程失败
```

此文档指导 Agent 执行**知识库条目生成**，支持单条、批量及优化模式。

> [!IMPORTANT]
> **目标**: 将零散的问题/方案转化为标准化的 QA 知识库条目。
> **原则**: 标题规范（关键词前置）、内容结构化（背景/方案/注意）、去冗余。
> **模板**: `jl-skills/templates/JL-Template-Knowledge-Entry.md`

---

## 模式 1: 单条目生成 (Single Entry)

### 步骤 1.1: 提取信息并生成预览

**你必须输出以下内容，然后停止**:

**提取内容**: 分析输入，提取问题场景、错误特征、解决步骤

### 步骤 1.2: 生成标题

**标题规则**: `【业务模块】动作 + 对象 (同义词)`
- 拒绝口语化
- 包含错误码（如有）

### 步骤 1.3: 撰写内容

**内容结构**:
1. **背景**: 一句话描述场景
2. **方案**: 编号列表，动词开头
3. **注意**: 权限与避坑

### 步骤 1.4: 去重

**去重内容**: 删除客套话和废话

### 步骤 1.5: 输出预览

**输出格式**:

````markdown
## 步骤 1: 单条目生成

📊 **进度**: [1/1] 单条目生成
[████████████████████] 100%

| ✅ 已完成 | 🔄 进行中 | ⏳ 待完成 |
|:----------|:----------|:----------|
| | 1.单条目生成 | |

---

### 生成的条目预览

**标题**: 【订单】退款申请失败处理 (订单状态不支持退款)

**内容**:
- **背景**: 客户在APP上点击退款时，提示"当前订单状态不支持退款"
- **方案**:
  1. 查询订单状态，确认是否已进入发货库
  2. 如已发货，联系仓库拦截
  3. 拦截成功后，更新订单状态为"待退款"
  4. 重新提交退款申请
- **注意**: 需要仓库权限，拦截时效为24小时

---

📋 **确认检查点**

条目生成是否满意？

- 回复 **确认** → 保存条目
- 回复 **调整标题: [新标题]** → 我将修改标题
- 回复 **调整内容: [说明]** → 我将修改内容
- 回复 **重新生成** → 我将重新生成

**请确认：** 条目是否满意？
````

**🛑 STOP HERE - DO NOT OUTPUT STEP 1.2 UNTIL USER CONFIRMS**

⚠️ **重要**: 用户未回复"确认"前，禁止执行任何后续步骤，禁止输出步骤1.2的内容。

---

## 模式 2: 批量生成 (Batch Generation)

**你必须输出以下内容，然后停止**:

### 步骤 2.1: 循环生成

**循环逻辑**: 对每个问题执行"单条目生成"逻辑

### 步骤 2.2: 逐条确认

**确认方式**: 每生成一条，简要展示并询问是否继续

### 步骤 2.3: 输出批量结果

**输出格式**:

````markdown
## 步骤 2: 批量生成

📊 **进度**: [2/3] 批量生成
[█████████████░░░░░░░] 67%

| ✅ 已完成 | 🔄 进行中 | ⏳ 待完成 |
|:----------|:----------|:----------|
| 1.单条目生成 | 2.批量生成 | 3.汇总 |

---

### 已生成的条目

| 序号 | 标题 | 状态 |
|------|------|------|
| 1 | 【订单】退款申请失败处理 | ✅ 已确认 |
| 2 | 【支付】支付超时处理 | 🔄 待确认 |

### 当前条目预览

**标题**: 【支付】支付超时处理 (支付未在30分钟内完成)

**内容**: [内容预览]

---

📋 **确认检查点**

当前条目是否满意？

- 回复 **确认** → 保存当前条目，继续下一个
- 回复 **调整: [说明]** → 我将修改当前条目
- 回复 **跳过** → 跳过当前条目，继续下一个
- 回复 **停止** → 停止批量生成

**请确认：** 当前条目是否满意？
````

**🛑 STOP HERE - 必须等待用户确认后才能继续**

⚠️ **重要**: 用户未回复"确认"前，禁止执行任何后续步骤。

---

### 步骤 2.4: 汇总结果

**输出格式**:

````markdown
## 步骤 3: 汇总

📊 **进度**: [3/3] 批量生成
[████████████████████] 100%

| ✅ 已完成 |
|:----------|
| 1.单条目生成 |
| 2.批量生成 |
| 3.汇总 |

---

### 生成清单

| 序号 | 标题 | 状态 |
|------|------|------|
| 1 | 【订单】退款申请失败处理 | ✅ 已保存 |
| 2 | 【支付】支付超时处理 | ✅ 已保存 |
| 3 | 【用户】登录失败处理 | ✅ 已保存 |

**总计**: 3 个条目已生成并保存

---

📋 **确认检查点**

批量生成是否完成？

- 回复 **确认** → 完成批量生成
- 回复 **调整: [条目序号]** → 我将修改指定条目

**请确认：** 批量生成是否完成？
````

**🛑 STOP HERE - 必须等待用户确认后才能继续**

⚠️ **重要**: 用户未回复"确认"前，禁止执行任何后续步骤。

---

## 模式 3: 条目优化 (Refine Entry)

### 步骤 3.1: 分析现有条目

**分析内容**: 评估现有条目的标题规范性、结构清晰度和冗余度

### 步骤 3.2: 重构条目

**重构内容**: 应用标准规则重写

### 步骤 3.3: 输出对比

**输出格式**:

````markdown
## 步骤 1: 条目优化

📊 **进度**: [1/1] 条目优化
[████████████████████] 100%

| ✅ 已完成 | 🔄 进行中 | ⏳ 待完成 |
|:----------|:----------|:----------|
| | 1.条目优化 | |

---

### 优化对比

| 项目 | 优化前 | 优化后 |
|------|--------|--------|
| **标题** | 订单退款问题 | 【订单】退款申请失败处理 |
| **结构** | 混乱描述 | 背景-方案-注意 |
| **冗余** | 包含客套话 | 精简到核心内容 |

### 优化后的条目

**标题**: 【订单】退款申请失败处理 (订单状态不支持退款)

**内容**: [优化后的内容]

---

📋 **确认检查点**

条目优化是否满意？

- 回复 **确认** → 保存优化后的条目
- 回复 **调整: [说明]** → 我将调整
- 回复 **保持原样** → 不保存优化

**请确认：** 条目优化是否满意？
````

**🛑 STOP HERE - 必须等待用户确认后才能继续**

⚠️ **重要**: 用户未回复"确认"前，禁止执行任何后续步骤。

---

## 知识库生成完成

**触发条件**: 用户确认后

**输出格式**:

````markdown
---

## ✅ 知识库条目生成完成

### 📄 已保存文件

**文件**: `docs/knowledge/{date}/[标题].md`

**条目统计**:
- ✅ 单条目: X 个
- ✅ 批量条目: X 个
- ✅ 优化条目: X 个

---

**后续建议**: 定期更新知识库，保持内容时效性
````

**🛑 STOP HERE - 生成完成**