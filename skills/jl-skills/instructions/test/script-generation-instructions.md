# 脚本生成指令 (Script Generation Instructions)

## ⚠️ 执行规则 (EXECUTION RULES)

```
🛑 CRITICAL: 
- 每个步骤输出后 MUST STOP
- 等待用户回复后才能继续
- 一次回复只输出一个步骤的内容
- 违反此规则将导致流程失败
```

此文档指导 Agent 执行场景测试生成的**步骤 3: 脚本生成（cURL 和 SQL）**。

> [!IMPORTANT]
> **目标**: 生成 cURL 和 SQL 准备脚本，在对话框中预览，最终写入报告。
> **原则**: 
> - 按照概览列出的全部场景一个一个实现
> - 脚本内容在对话框中显示（便于审查）
> - 脚本最终写入报告，不单独生成文件

---

## 步骤 3.1: 脚本生成说明

**你必须输出以下内容，然后停止**:

**确认内容**:
1. 回顾步骤1的场景概览表
2. 确认需要为哪些场景生成脚本

**输出格式**:

````markdown
## 步骤 3: 脚本生成（cURL 和 SQL）

📊 **进度**: [3/5] 脚本生成
[████████████░░░░░░░░] 60%

| ✅ 已完成 | 🔄 进行中 | ⏳ 待完成 |
|:----------|:----------|:----------|
| 1.场景概览 | 3.脚本生成 | 4.报告写入 |
| 2.流程介绍 | | 5.Python测试脚本 |

---

### ⚠️ 脚本生成说明

**生成规则**:
- ✅ cURL 和 SQL 脚本将在对话框中显示（便于审查）
- ✅ 按照概览列出的全部场景一个一个实现
- ✅ 每个场景都会生成对应的 cURL 和 SQL 脚本
- ✅ 脚本最终写入报告文件，不单独生成文件

**脚本用途**:
- cURL 脚本：用于接口请求测试
- SQL 脚本：用于数据准备、结果校验和环境清理

**场景列表**（共 X 个）:
- TC-001: [场景名称]
- TC-002: [场景名称]
- TC-003: [场景名称]
- ...

---

📋 **确认检查点**

是否开始生成脚本？

- 回复 **确认** → 立即开始生成脚本并写入文件
- 回复 **调整** → 我将修改生成策略

**请确认：** 是否开始生成脚本？
````

**🛑 STOP HERE - DO NOT OUTPUT STEP 3.2 UNTIL USER CONFIRMS**

⚠️ **重要**: 用户未回复"确认"前，禁止执行任何后续步骤，禁止输出步骤3.2的内容。

---

## 步骤 3.2: 生成脚本内容并在对话框显示

**你必须输出以下内容，然后停止**:

**生成规则**:
1. **cURL 脚本**: 为每个场景生成对应的 cURL 命令，使用占位符 `{{BASE_URL}}`, `{{TOKEN}}` 等
2. **SQL 准备脚本**: 为每个场景生成准备脚本、校验脚本、清理脚本
3. **脚本组织**: 按场景顺序组织，每个场景一个部分

**执行规则**:
- ⚠️ **重要**: 脚本内容**在对话框中显示**，便于用户审查
- 按照场景顺序逐个生成并显示
- 脚本内容保留在内存中，等待步骤4写入报告

**输出格式**:

````markdown
### ✅ 脚本已生成

**脚本统计**:
- ✅ cURL 脚本: X 个场景
- ✅ SQL 脚本: X 个场景
- ✅ 每个场景包含：准备脚本、校验脚本、清理脚本

---

### A. 接口请求 (cURL)

#### TC-001: [场景名称]

```bash
curl -X POST "{{BASE_URL}}/your/api/path" \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer {{TOKEN}}" \
  -d '{
    "procKey": "sample_process",
    "businessData": { ... }
  }'
```

#### TC-002: [场景名称]

```bash
...
```

---

### B. 数据准备与校验 (SQL)

#### TC-001: [场景名称]

```sql
-- 1. 前置清理/准备
DELETE FROM biz_table WHERE batch_no = 'TEST_001';

-- 2. 预期结果校验 (验证脚本)
SELECT status, proc_inst_id FROM biz_table WHERE batch_no = 'TEST_001';
-- 预期: status 应该为 'CREATED'
```

#### TC-002: [场景名称]

```sql
...
```

---

**脚本内容说明**:
- cURL 脚本使用占位符 `{{BASE_URL}}` 和 `{{TOKEN}}`，需要替换为实际值
- SQL 脚本包含数据准备、结果校验和环境清理
- 这些脚本将在步骤4写入报告文件

---

📋 **确认检查点**

脚本生成是否完成？

- 回复 **确认** → 进入报告写入（脚本将写入报告）
- 回复 **调整脚本: [具体说明]** → 我将修改脚本

**请确认：** 脚本生成是否完成？
````

**🛑 STOP HERE - DO NOT OUTPUT STEP 3.3 UNTIL USER CONFIRMS**

⚠️ **重要**: 用户未回复"确认"前，禁止执行任何后续步骤，禁止输出步骤3.3的内容。